"use strict";var kapost={selectors:{form:$(".kn-form"),projectTypes:$("#project-type"),deliverables:$("#deliverables"),businessUnit:$("#business-unit"),industryVertical:$("#industry-vertical"),assetTitle:$("#asset-title"),kapostNum:$("#kapost-number"),createBtn:$(".kn-create-btn"),resetBtn:$(".kn-reset-btn"),outputContainer:$(".output-container"),output:$("#final-name-output"),copyBtn:$(".kn-copy-name")},formData:null,output:{company:"Rackspace",contentType:"",docTitle:"",vertCode:"",prodCode:"",kapostNum:""},finalName:null,setForm:function(t){var e=this,o=this.selectors.projectTypes,n=this.selectors.deliverables;o.append('<option value="none">What kind of project?</option>'),t.projectTypes.forEach(function(t){return o.append('<option value="'+t.type+'">'+t.type+"</option>")}),o.on("change",function(t){var i=e.formData.projectTypes.find(function(e){return e.type===t.target.value});n.html(""),i?(e.output.contentType=e.sanitizeDeliv(i.deliverables[0]),i.deliverables.forEach(function(t){return n.append('<option value="'+t+'">'+t+"</option>")})):e.output.contentType="",e.validateItem(o),e.validateItem(n)}),n.on("change",function(t){e.output.contentType=e.sanitizeDeliv(t.target.value),e.validateItem(n)});var i=this.selectors.businessUnit;i.append('<option value="none">Who\'s this for?</option>'),t.businessUnit.forEach(function(t){return i.append('<option value="'+t.value+'">'+t.name+"</option>")}),i.on("change",function(t){e.output.prodCode=t.target.value,e.validateItem(i)});var a=this.selectors.industryVertical;a.append('<option value="none">Select</option>'),t.industryVertical.forEach(function(t){return a.append('<option value="'+t.value+'">'+t.name+"</option>")}),a.on("change",function(t){e.output.vertCode=t.target.value,e.validateItem(a)});var r=this.selectors.assetTitle;r.on("input",function(t){var o=e.sanitizeTitle(t.target.value);t.target.value=o,e.output.docTitle=o,e.validateItem(r)});var s=this.selectors.kapostNum;s.on("input",function(t){var o=e.sanitizeNumber(t.target.value);t.target.value=o,e.output.kapostNum=o,e.validateItem(s)})},sanitizeDeliv:function(t){return t.replace(/\s/g,"-")},sanitizeTitle:function(t){return t.replace(/[^a-zA-Z0-9]/g,"-")},sanitizeNumber:function(t){return t.replace(/[^0-9]/g,"")},getData:function(){var t=this;return $.getJSON("./form-options.json").done(function(e){t.formData=e,t.setForm(e)}).fail(function(){return console.log("There was an issue getting the form data")})},buildName:function(){var t=this.output,e=t.company+"-"+t.contentType+"-"+t.docTitle+"-"+t.vertCode+"-"+t.prodCode+"-"+t.kapostNum;this.finalName=e,this.selectors.output.html(e),console.log(e)},resetForm:function(){this.selectors.deliverables.html(""),this.output={company:"Rackspace",contentType:"",docTitle:"",vertCode:"",prodCode:"",kapostNum:""},this.selectors.output.html(""),this.selectors.outputContainer.removeClass("file-built"),this.clearErrors()},clearErrors:function(){this.selectors.form.find("select, input").each(function(){var t=$(this),e=t.next("span.kn-form-error");e.length&&(t.removeClass("kn-field-error"),e.remove())})},validateItem:function(t){var e=!0,o=t.val(),n=t.next("span.kn-form-error");return"none"!==o&&o&&""!==o.trim()||"required"!==t.attr("data-validate")?n.length&&(t.removeClass("kn-field-error"),n.remove()):(e=!1,n.length||(t.addClass("kn-field-error"),$('<span class="kn-form-error">This value is required!</span>').insertAfter(t))),e},validateAll:function(){var t=!0;this.selectors.form.find("select, input").each(function(){t=kapost.validateItem($(this))}),t?(this.selectors.outputContainer.addClass("file-built"),this.buildName()):this.selectors.outputContainer.removeClass("file-built")},copyFileName:function(){var t=this;this.finalName&&(clipboard.writeText(this.finalName),this.selectors.copyBtn.addClass("kn-copied"),this.selectors.output.addClass("kn-copied-output"),setTimeout(function(){t.selectors.copyBtn.removeClass("kn-copied"),t.selectors.output.removeClass("kn-copied-output")},1500))},init:function(){var t=this;this.getData(),this.selectors.createBtn.click(function(e){e.preventDefault(),t.validateAll()}),this.selectors.resetBtn.click(function(){t.resetForm()}),this.selectors.copyBtn.click(function(e){e.preventDefault(),t.copyFileName()})}};kapost.init();